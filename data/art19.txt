A first look at the topology of reionization redshifts in models of the Epoch of the Reionization
ABSTRACT
Context. During the Epoch of Reionization (EoR), the first stars and galaxies appear while creating ionized bubbles that will eventually
percolate near z ∼ 6. These ionized bubbles and percolation process are nowadays under a lot of scrutiny since observations of the
neutral hydrogen gas will be carried on in the next decade with for example the Square Kilometre Array (SKA) radio-telescope. In
the meantime, studies of the EoR are performed on semi-analytical and fully numerical cosmological simulations to investigate for
instance the topology of the process.
Aims. We analyse the topology of EoR models through the study of regions that are under the radiative influence of ionization sources.
Those regions are associated with peak patches of the reionization redshift field, for which we measure their general properties such
as their number, size, shape and orientation. We aim at gaining insights on the geometry of the reionization process and how it relates
to the matter distribution for example. We also assess how such measurements can be used to quantify the influence of physical
parameters on the reionization models or the differences between fully numerical simulations and semi-analytical models.
Methods. We use the framework of the Morse theory and the persistent homology in the context of the Reionization, which is
investigated via the DisPerSE algorithm on gas density and redshift of reionization maps. We analyse different Reionization scenarios
with semi-analytical 21cmFAST and fully numerical EMMA simulations.
Results. We find that we can distinguish between Reionization models with different sources using simple analyses on the number,
shape and size distributions of the reionization redshift patches. Meanwhile, for every model (of semi-analytical and fully numerical
simulations), we statistically show that those bubbles are rather prolate and aligned with the underlying filaments of gas. Moreover, we
briefly highlight that the percolation process of HII bubbles during the EoR can be followed by studying the reionization redshift fields
with different persistence thresholds. Finally, we show that fully numerical EMMA simulations can be made consistent with 21cmFAST
models in this topological framework as long as the source distribution is diffuse enough.
Key words. Cosmology: large-scale structure of Universe, dark ages, reionization, first stars – Methods: numerical – Galaxies:
formation, high-redshift
1. Introduction
The Epoch of Reionization (EoR) marks the transition of a totally neutral to a fully ionized Universe, with its large scales
structures composed of filaments, voids and very dense regions.
During the EoR, the first sources of radiation appear, releasing the photons required to ionize the cosmic gas. Light escaping from those first stars and galaxies creates HII regions (also
known as HII "bubbles") that eventually percolate at the end of
Reionization between z = 5.3 − 6 (Kulkarni et al. 2019).
This Epoch is nowadays under many studies to try to understand for instance which kind of sources drove the EoR or
how and when the HII bubbles overlap. Analysing the large scale
topology of the EoR is useful to unravel the properties of the object that drove the Reionization, such as the nature of the driving
sources of the EoR, their spatial distribution, the timing of their
appearance or the spectrum of their radiation (see for instance
Chardin et al. (2017)).
Complementary to studies using the power spectrum for instance (e.g. Mellema et al. (2006); Dixon et al. (2016); Shaw
et al. (2020)), many works try to tackle those questions with a
topological approach of the epoch of Reionization. For example,
Minkowski functionals (and the derived genus or Euler characteristic) are used to analyse the volume, surface aera and curvature of ionized and neutral regions, giving information on the
shape of these regions and the percolation process (as in e.g.
Gleser et al. (2006); Lee et al. (2008); Friedrich et al. (2011);
Hong et al. (2014); Yoshiura et al. (2017); Chen et al. (2019)).
Other studies focus on the size distributions of neutral or ionized regions (also respectively called Island Size Distribution or
ISD and Bubble Size Distribution or BSD) which characterise
the size of neutral islands or HII bubbles and their percolation
during the EoR. Examples of methods used in such studies are
the Friend-Of-Friend algorithm (Iliev et al. 2006; Friedrich et al.
2011; Lin et al. 2016; Giri et al. 2018, 2019), the Spherical Average Method (Zahn et al. 2007; Friedrich et al. 2011; Lin et al.
2016; Giri et al. 2018), the Mean-Free-Path method (Mesinger &
Furlanetto 2007; Lin et al. 2016; Giri et al. 2018, 2019), and the
granulometry method (Kakiichi et al. 2017). The Betti numbers,
related to 3D structures of a field (isolated objects, tunnels and
cavities), are also used to probe the topology of ionized bubbles
and neutral islands during Reionization (Giri & Mellema 2020).
The Triangle Correlation Function (TCF) is another tool to extract topological information, such as the radius and the shape of
ionized and neutral bubbles (Gorce & Pritchard 2019). It relies
on a 3-points correlation function based on the inverse Fourier
Article number, page 1 of 13
arXiv:2111.11910v1 [astro-ph.CO] 23 Nov 2021
A&A proofs: manuscript no. aanda
transform of the bispectrum that describes the phase of the signal of interest.
Upcoming observations from radio interferometers like the
New Extension in Nançay Upgrading loFAR1
(NenuFAR, Zarka
et al. (2012)) and the low frequency component of the Square
Kilometre Array2
(SKA-Low, see for instance Mellema et al.
(2013)) will allow us to map the sky with HI regions through the
redshifted 21-cm signal emitted during Reionization (Mellema
et al. 2015). SKA will produce 2D tomographic images of the
21-cm emission of the EoR at many redshifts. Geometrical studies can therefore focus directly on the 21-cm fields, using for example the 21-cm power spectrum (see Kim et al. (2013); Choudhury & Paranjape (2018); Seiler et al. (2019); Pagano & Liu
(2020)) or the 21-cm bispectrum (see Hutter et al. (2020)) to
extract topological information, such as the size distribution of
ionized bubbles.
In this study, we also propose to explore the EoR through
its topology, but using the Discrete Persistent Structure Extractor, also called DisPerSE3
(Sousbie 2011). This code relies on
the discrete Morse theory and persistent homology. By computing gradients and critical points of fields, it extracts geometrical
properties, among which peaks, walls, filaments and voids for a
3D field. The persistent homology is used in this algorithm to
only focus on significant features and for instance takes into account the noise in data sets by providing a way to suppress it by
tuning a persistence level. DisPerSE has been written in order
to analyse astrophysical structures and especially the large scale
density structures of the Universe. Since then, many studies have
extracted and analysed the matter filaments with DisPerSE from
cosmological simulations (e.g. Singh et al. (2020); GalárragaEspinosa et al. (2020); Katz et al. (2020); Song et al. (2021)),
observations (e.g. Malavasi et al. (2020); Tanimura et al. (2020))
or both (e.g. Sousbie et al. (2011)). Persistent homology has also
been used on phenomenological models of the EoR to study the
topology of HII regions (Elbers & van de Weygaert 2019).
In this work, we extracted the filaments of the matter density
field but also the peak patches of the redshift of reionization field
or zreion (Battaglia et al. 2013; Deparis et al. 2019) from EoR
simulations produced by the semi-analytical code 21cmFAST4
(Murray et al. 2020; Mesinger et al. 2011) and the simulation
code EMMA (Electromagnétisme et Mécanique sur Maille Adaptative, Aubert et al. (2015)). The zreion field is a measure of the
redshift at which each point in space has been reionized. It contains therefore spatial and temporal information on the propagation of radiation from sources of reionization in a single field per
simulation. Using DisPerSE, we apply the Morse theory framework to the 3D field of our different models. As detailed later
on, maxima (peaks) in zreion correspond to the seeds, the first
sources, of local reionizations. Peak patches around these seeds
represent the extent of their time-integrated radiative influence.
Even though we did not investigate them in the current work,
walls or filaments in zreion define the regions where percolation
occurred. We believe that such an approach can complement the
ones based on the study of HII regions at a single or a sequence
of redshifts. Possibly, the shape of these zreion patches can give
us an indication on the way radiation get out of galaxies. Their
size could inform us on the extent of the radiative influence of
the different kinds of sources, in relation for example to the large
absorption trough in the quasar spectra (Becker et al. 2015) or to
1 https://nenufar.obs-nancay.fr
2 https://www.skatelescope.org
3 http://www2.iap.fr/users/sousbie/web/html/indexd41d.html
4 https://github.com/andreimesinger/21cmFAST
the understanding of the observed large fluctuations of UV radiation (Chardin et al. 2017). In general, one could expect a different long-range influence by faint/locally sub-dominant sources
compared to more dominant emitters. Overall, we believe that
the Morse theory framework as implemented by DisPerSE provides a solid and reproducible mathematical description of the
zreion geometry, that could be used to characterise and compare
models of the EoR. In this initial study, we gain first insights on
the extent of the zreion patches, their shapes and their relative orientation to the underlying gas distribution. We compare different
EoR models from 21cmFAST and EMMA.
In this paper, we first describe in Sect. 2 the methodology
we employ by presenting our simulations, the reionization redshift field, the DisPerSE algorithm and the method we use to extract the orientation and shape of the patches. Afterwards, Sect.
3 shows our first topological analyses: number of seeds of reionization, shape and size of the reionization patches. Sections 4 and
5 highlight the differences between simulations with different parameters, as well as studies of the orientation of radiation with
respects to the underlying density. Section 6 presents a comparison of the topology of the EoR in semi-analytical and cosmological simulations. We finally conclude in Sect. 7. In the whole paper, the cosmology parameters used are (Ωm, Ωb, ΩΛ, h, σ8, ns) =
(0.31, 0.05, 0.69, 0.68, 0.81, 0.97) as given by Planck Collaboration et al. (2020).
2. Methodology
2.1. Simulated data
At first, we get 3D cosmological simulations from the semianalytical code 21cmFAST (version 3.0.3; Murray et al. (2020);
Mesinger et al. (2011)). 21cmFAST evolves initial density and
velocity fields thanks to the first- or second- order perturbation
theory of Zel’Dovich (1970), and provides associated predictions such as temperature, ionization, 21-cm signal and radiation
fields.
In our case, the ionized gas evolves in a 1893
cMpc3 box at a
resolution of 1.483
cMpc3
(or boxes of 1283
cMpc3
/h
3 with 1283
cells). Different physical models are studied in this work using
two parameters of 21cmFAST: the virial temperature Tvir and the
ionizing efficiency ζ, as defined by Greig & Mesinger (2015):
– Tvir is the minimal virial temperature for a halo to start the
star-formation process. It allows to control the gas accretion,
the cooling and the retainment of supernovae outflows, and it
is related to the halo mass through Mmin ∝ T
3/2
vir . The higher
the virial temperature, the heavier the halos.
– ζ is the ionizing efficiency of high-z galaxies. It defines the
number of photons escaping from galaxies, and higher values
tend to accelerate the Reionization.
The parameters of our different models are shown in Table
1. We separate the models into two sets of simulations: a set
varying ζ and Tvir, called the Same Reionization History (SRH)
set, and a set varying only ζ, called the Different Reonization
History (DRH) set. For the SRH simulations set, virial temperatures have been set first before tuning the ionizing efficiency
in order to get the same history of reionization. Then, the larger
Tvir is, the larger ζ is in order to maintain the same history of
reionization since only the heaviest halos radiate, meaning that
they are also fewer to release photons. The DRH simulations set
have been made in order to analyse the impact of different emissivities and thus reionization histories. 101 realisations of each
model have been made using different seeds in 21cmFAST. The
ionization histories of Fig. 1 are averaged on all the realisations
Article number, page 2 of 13
Emilie Thélie et al.: A first look at the topology of reionization redshifts in models of the Epoch of the Reionization
Model ζ Tvir [K] (log10(Tvir))
1 6.5 3.2 × 103
(3.5)
2 12 1 × 104
(4)
3 30 5 × 104
(4.69897)
4 55 1 × 105
(5)
5 150 2.5 × 105
(5.4)
3 30 5 × 104
(4.69897)
3-1 40 5 × 104
(4.69897)
3-2 55 5 × 104
(4.69897)
3-3 100 5 × 104
(4.69897)
3-4 300 5 × 104
(4.69897)
Table 1. Parameters of the 21cmFAST simulated models. There are five
models that change ζ and Tvir that belong with the Same Reionization
History (SRH) set, and four other models modifying the ζ parameter
from the fiducial model #3, which form the Different Reionization History (DRH) set. The values of Tvir are also given in logarithm.
4 6 8 10 12 14 16
z
0.0
0.2
0.4
0.6
0.8
1.0
Ionized volume fraction
= 6.5 - log10(Tvir) = 3.5
= 12.0 - log10(Tvir) = 4.0
= 30 - log10(Tvir) = 4.69897
= 40 - log10(Tvir) = 4.69897
= 55 - log10(Tvir) = 4.69897
= 100 - log10(Tvir) = 4.69897
= 300 - log10(Tvir) = 4.69897
= 55.0 - log10(Tvir) = 5.0
= 150.0 - log10(Tvir) = 5.4
Fig. 1. Ionized volume fraction of sets of 21cmFAST simulations having
different models, each one of them averaged on their 101 realisations.
of each model. Figure 1 shows the ionized volume fraction of all
models.
2.2. Reionization redshift maps
As mentioned in the Introduction, the geometry of ionization is usually investigated via the ionized fraction distribution
xHII(r,z) at a given redshift z or with a sequence of redshifts,
where r stands for the 3D position. Here, we rather focus on the
reionization redshift field zreion. It is obtained by saving for each
position the redshift at which the gas is considered to be ionized, that is when the ionization fraction gets higher than a given
threshold which is set at 50%5
, as follows:
zreion(r) = z(r, xHII = 0.5). (1)
It incorporates spatial and temporal information on the propagation of radiation during the Epoch of Reionization in a single
field (Battaglia et al. 2013; Deparis et al. 2019; Trac et al. 2021)
and can be seen as a reciprocal of or dual to the xHII field.
5 A few cells are not reionized at the end of the simulations (z = 5.5).
The reionization redshift of those cells is manually set to 5.5 in the zreion
map.
0 20 40 60 80 100 120
x
0
20
40
60
80
100
120
y
= 30 - log10(Tvir) = 4.69897
slice z=64 6
8
10
12
14
16
18
zreion
Fig. 2. 2D slice at depth z = 64 of the reionization redshift field extracted from the 21cmFAST simulation (model ζ = 30 and Tvir = 5×104
K).
Figure 2 shows an example of a reionization redshift map extracted from a 21cmFAST simulation. The bluest regions correspond to the places where the gas was reionized the first and can
be interpreted as the local seeds of the local reionization process.
Ionization fronts propagated around those zreion peaks towards
the reddest regions which have reionized later on, forming connected regions of varying shapes and extent: these regions represent the local radiative influence of these local seeds, integrated
over time.
2.3. DisPerSE
DisPerSE relies on the Morse theory in order to analyse the
topology of manifolds through the study of differential functions.
This code searches for critical points in a field, such as maxima,
minima and saddle points. DisPerSE also looks for the integral
lines (or field lines) of the field: they are the tangent curves to
the gradient in every point, and always have critical points as
origin and destination. As those lines cover all space, one can
produce a tessellation of the space, creating regions called ascending or descending manifolds. Finally, the set of all ascending/descending manifolds (also known as peak or void patches)
is called the Morse complex of a field.
Within DisPerSE, one can tune the so-called "persistence"
to control the significance of the topological features found in
fields (see Sousbie (2011)). It can be seen as a significance
threshold that separates two critical points, and the local critical
points of the field which are not significant enough are ignored.
It allows to control the smoothness of the resulting topological
features and can be used to get rid of the noise in the input data.
Figure 3 illustrates the impact of applying a persistence threshold on a 1D field (left column) on which a persistence threshold
is applied (right column). Let’s consider a pair of critical points:
a minimum (in blue) and a maximum (in red). The distance between the value of the field at those points (green arrows) is compared to the value of the chosen persistence threshold (distance
between the two purple dashed lines): if it is larger than the persistence, those extrema are considered when detecting and assigning points to patches; but if it is smaller, they are discarded,
as if they were filtered out from the field. In this case the field
becomes topologically "smoother".
Article number, page 3 of 13
A&A proofs: manuscript no. aanda
persistence
Fig. 3. Illustration of the persistence parameter of the DisPerSE algorithm. It shows a 1D function, with red dots as maxima and blue dots as
minima. The left column is the actual function on which the persistence
threshold is applied, while on the right one, there is the result after applying this threshold. The length between the purple dashed lines represents the persistence threshold in that case. The green arrows represent
the smoothing of the curve when eliminating the corresponding critical
points. This illustration is inspired by Sousbie (2011).
Before using DisPerSE, the gas density δ(r) and the reionization redshift zreion(r) are first converted into dimensionless 3D
fields by applying the following transformation on them:
δa =
δ − δ
σδ
, (2)
zreion,a =
zreion − zreion
σzreion
, (3)
where δ and zreion are the mean of each field and σδ and σzreion
are their standard deviation. These transformations allow us to
express the persistence parameter in term of the deviation of a
field to its mean value, letting us know at how many σ the fields
will be smoothed from a topological point of view. Moreover,
the fields are also filtered with a Gaussian kernel (with a standard
deviation of 1 cell for each field) in order to avoid the presence
of large patches of constant field values that prevent DisPerSE
to run properly.
In our study, we first apply the DisPerSE algorithm with a
persistence level of 0.5 − σ (Sousbie et al. 2011; Codis et al.
2018; Galárraga-Espinosa et al. 2020; Cohn 2021) on the 3D
reionization redshift field of our simulations in order to get the
zreion patches associated with the zreion maxima6
. They correspond to the regions that are topologically associated to a given
zreion maximum, which gather all the cells of the simulations
that have a positive gradient toward their maximum. Those maxima are the first places to reionize: they are the seeds of local
reionizations. Again, these patches are different from the "ionized bubbles" usually mentioned in the literature (see e.g. Chen
et al. (2019); Gorce & Pritchard (2019); Giri et al. (2019); Giri
& Mellema (2020)), that are regions where the hydrogen gas is
ionized at a given time. The cells within the patches discussed
here are connected through time via the topology of zreion, providing another insight on the propagation of ionization fronts
and on the extent of the influence of the reionization seeds. Figure 4 shows reionization redshift maps superimposed to the contours of their segmentation obtained with DisPerSE. One can
see that the patches are naturally centred around the maxima,
not necessarily spherical, and have different kinds of sizes and
shapes (keeping in mind that 3D effects can be hidden on these
2D maps) depending on the local specificities of the production
and absorption of radiation.
6
In practice, DisPerSE compute the ascending 3-manifolds of the
field using the integral lines that are related to the maxima of the 3D
field (see Sousbie (2011) for more details).
We are also interested in the filaments of the gas density
structures present in our models. With DisPerSE, they are detected as the set of points/cells in the density field belonging to
arcs that have saddle points as origin and extrema as destination.
We apply this selection to the gas density fields in our simulations using a 0.5 − σ persistence level. Figure 5 is an example of
a density map from a 21cmFAST simulation superimposed to the
filaments detected with DisPerSE. The map is obtained from an
average of several slices for a better visualisation and clearly the
filaments follow the distribution of the gas in the box.
2.4. The inertial tensor, a tool to get the orientation of an
object
Our study will assess the shape and size of the reionization
patches, as well as their orientation with respect to the gas filaments. We use inertial tensors, as defined by Tormen (1997):
Ii, j =
X
k
ωk · (xk,i − xre f,i) · (xk, j − xre f, j). (4)
Here, k scans all of the cells within the patches, i, j ∈ {1, 2, 3} refer to the Cartesian components of the cells position x and ω is a
weight. xre f is a point of reference: in our case, it is the geometrical centre of each patch. The eigenvectors of the tensor provide
the 3D directions of the extension of the patches and the eingenvalues the typical extent of the cells along these directions. The
eigenvector with the largest eigenvalue represents therefore the
main axis of a given patch. The same procedure can be applied
to the cells belonging to a given gas filament, in order to extract
its main orientation.
For zreion patches, we use ωk = 1, as we are only interested in
the geometrical shape, and their main axis represents the direction favoured by radiation after having been emitted by the local
seed. Presumably, it corresponds to the path of least resistance
for radiation or is indicative of the geometry of light production
as ionization fronts propagated. For gas filaments, since we are
interested in their orientation relatively to the reionization patch
they are located in, we set ωk to the cell density and restrict ourselves to cells that are within that reionization patch.
3. First topological insights
3.1. Number of reionization patches
On Fig. 6, one can see the number of reionization patches in every model (accumulating all realisations). It should be noted that
the parameters evolving from one simulation to the other, Tvir
and ζ, only have an impact on the radiation processes whereas
the density maps are not modified between the different (Tvir, ζ)
models, and for instance the filaments are necessarily the same.
One can see that the number of reionization patches (or reionization seeds) decreases with increasing Tvir (and then ζ, see the top
panel of Fig. 6 representing the SRH set): with larger Tvir, there
are less emitting halos as it favours the massive ones (which also
produce more photons to maintain a reionization with the same
history). Now, for the DRH simulations set (i.e. with the same
emitting halos but different ionizing efficiencies), the number
of reionization patches as a function of the ionizing efficiency
parameter presents two regimes. We would have expected the
number of reionization patches to only decrease with increasing
ζ: when the sources emit more radiation, the first regions expand rapidly, preventing the smaller and later-formed halos to
create their own patches. The latter sources are then ionized by
Article number, page 4 of 13
Emilie Thélie et al.: A first look at the topology of reionization redshifts in models of the Epoch of the Reionization
6
8
10
12
14
16
18
zreion
0 20 40 60 80 100 120
x
0
20
40
60
80
100
120
y
= 30 - log10(Tvir) = 4.69897
slice z=64
866 regions in the whole box
0 20 40 60 80 100 120
x
0
20
40
60
80
100
120
y
= 55 - log10(Tvir) = 4.69897
slice z=64
1026 regions in the whole box
0 20 40 60 80 100 120
x
0
20
40
60
80
100
120
y
= 300 - log10(Tvir) = 4.69897
slice z=64
955 regions in the whole box
Fig. 4. 2D slices of zreion fields extracted from a realisation of 21cmFAST simulations. The reionization redshifts are superimposed to the contours
(in black) of the patches from the segmentation obtained with DisPerSE (with a persistence level of 0.5 − σ). The three panels represent three
models (of the DRH simulations set) with different ζ value: models #3 (ζ = 30), #3-2 (ζ = 55) and #3-4 (ζ = 300) from left to right.
0 20 40 60 80 100 120
x
0
20
40
60
80
100
120
y
= 30 - log10(Tvir) = 4.69897
slice z=64
0.5
0.0
0.5
1.0
1.5
2.0
Fig. 5. 2D slice of the density field extracted from a 21cmFAST simulation (model ζ = 30 and Tvir = 5 × 104 K). The density is superimposed
to the filaments (in black) obtained with DisPerSE (with a persistence
level of 0.5 − σ). This map is made from an average of many slices to
better visualise the filaments.
external emitters, and belong to the patches of these earlier external "reionizers". For instance, this behaviour can be seen in
the purple boxed patch in the middle and right panels of Fig. 4.
It shows reionization redshift fields for ζ values of 55 and 300
superimposed to their DisPerSE segmentations. As ζ increases,
four small patches merge as bright early emitters expand their
influence more efficiently and late emitters are externally reionized. However, the number of patches increases as ζ increases
from 30 to 55. We checked that this behaviour is an artefact of the
way the DisPerSE segmentations are produced in this study. The
zreion field is smoothed before being processed by DisPerSE, filtering out small patches of low emitters with weak gradients.
As ζ increases, the extent and the gradients are enhanced within
such patches and the latter are not suppressed by the Gaussian
smoothing and the persistence filter. This effect is illustrated in
the left and middle panels of Fig. 4. Only two patches are detected within the purple box at low ζ, while four patches can be
seen as this parameter is increased to moderately larger values.
The number of patches is related to the first Betti number β0
of an ionization field as it represents the number of sources of
= 6.5
log10(Tvir) = 3.5
= 12.0
log10(Tvir) = 4.0
= 30
log10(Tvir) = 4.69897
= 55.0
log10(Tvir) = 5.0
= 150.0
log10(Tvir) = 5.4
0
20000
40000
60000
80000
100000
120000
Nregions
9.88E+04
9.18E+04
8.11E+04
7.24E+04
5.17E+04
= 30
log10(Tvir) = 4.69897
= 40
log10(Tvir) = 4.69897
= 55
log10(Tvir) = 4.69897
= 100
log10(Tvir) = 4.69897
= 300
log10(Tvir) = 4.69897
0
20000
40000
60000
80000
100000
120000
Nregions
8.11E+04
9.90E+04 1.02E+05 9.91E+04
9.41E+04 Fig. 6. Number of patches detected with DisPerSE (with a persistence
level of 0.5 − σ) for every model mentioned in Table 1. The top panel
represents the models of the SRH set while the bottom panel shows the
models of the DRH set. For each model, one adds the patches numbers
of every realisation.
ionization (Giri & Mellema 2020). Giri & Mellema (2020) compute the β0 number of their xHII ionization field throughout the
Reionization process for models that vary only the ionizing efficiency (see their FN1 and FN2 models and the top left panel
of their Fig. 6 where they accumulate the number of sources as
xHII grows). Those models can be compared to our DRH set
models for which we have histories of reionization (for the lowest ζ models) similar to theirs. They conclude that the β0 numbers of these two models are approximately the same, but with
slightly less sources, for the model with the highest ζ. Meanwhile, we conclude that reionization patches appear sooner (see
Article number, page 5 of 13
A&A proofs: manuscript no. aanda
Fig. 1) and their total number throughout the reionization history
is lower for the highest ζ models, (see Fig. 6) which is consistent
with the results of Giri & Mellema (2020).
3.2. Shapes of the reionization patches
With the eigenvalues given by the inertial tensors, one can compute a number quantifying the geometrical shape of the patches.
Tormen (1997) called it the triaxiality parameter and defined it
as follows:
T =
λ
2
3
− λ
2
2
λ
2
3
− λ
2
1
. (5)
The λi (with i ∈ {1, 2, 3}) are the eigenvalues of the inertial tensors with λ1 ≤ λ2 ≤ λ3. When 0 ≤ T ≤
1
3
, the object is oblate: it
has two large dimensions and one small, like a flattened sphere.
When 1
3
≤ T ≤
2
3
, the object is "triaxial". When 2
3
≤ T ≤ 1, the
object is prolate: it has one large dimension and two small ones,
like a rugby ball. The top panel of Fig. 7 shows the probability
distribution functions of the triaxiality parameters computed for
the reionization patches of each realisation of every model. They
all return a similar distribution with a majority of prolate patches
and a minority of oblate ones. The normalisation of these distributions with the fiducial model (bottom panel) reveals small
differences between the SRH models though: the more Tvir and
ζ increase, the less there are prolate patches.
These prolate or "cigar" shapes of the reionization patches is
reminiscent of the "Ionized Fibres" stage as it is called in Chen
et al. (2019). Using Minkowski Functionals they could separate
in five stages the process of Reionization: an "Ionized Bubble"
stage where the first isolated ionized bubbles appear, an "Ionized Fibres" stage where bubbles start to connect to each other
forming a large fibre structure, a "Sponge" stage with intertwined
ionized and neutral regions, and "Neutral Fibre" and "Neutral Islands" stages, which are the neutral counterpart of the two first
stages. In our segmentations, patches seem to have kept a memory of the fibre shape of the second stage of Chen et al. (2019).
3.3. Size distribution of the reionization patches
We compute the probability distribution function of the volume
of the reionization patches. Figure 8 shows those PDFs for the
two sets of simulations. One can notice that patches with intermediate volumes dominate the simulation box. There is indeed a
limit on the largest volume due to the finite size of the box and on
the smallest volumes because of the resolution. Comparing the
different models of the SRH set, the largest virial temperatures
favour the ionization by the more massive halos that are stronger
emitters: it leads to larger but fewer reionization patches. A similar trend is measured for the DRH set, when ζ becomes large,
with fewer and more prominent patches. From our size distributions, one can extract a typical "radius" of patches of ∼ 10
cMpc/h, consistent for instance with the radii found by Gorce &
Pritchard (2019) with their Triangle Correlation Function.
The size distribution of patches returns a general information of the maximal radius HII regions can reach before percolation during the whole reionization process. It thus provides insights about the required size for cosmological simulations of the
EoR to use the framework described in this work. For example,
our PDFs of the patches volumes indicate that our boxes (128
cMpc/h) do not limit typical-sized patches (10 cMpc/h), however
it is not clear yet what kind of cut-off is applied to these PDFs in
the regime of large reionization patches. It is for instance known
0.0 0.2 0.4 0.6 0.8 1.0
Treg
10
2
10
1
10
0
d
Nregions / d
Treg
oblate triaxial prolate
= 6.5 - log10(Tvir) = 3.5
= 12.0 - log10(Tvir) = 4.0
= 30 - log10(Tvir) = 4.69897
= 40 - log10(Tvir) = 4.69897
= 55 - log10(Tvir) = 4.69897
= 100 - log10(Tvir) = 4.69897
= 300 - log10(Tvir) = 4.69897
= 55.0 - log10(Tvir) = 5.0
= 150.0 - log10(Tvir) = 5.4
0.0 0.2 0.4 0.6 0.8 1.0
Treg
0.8
0.9
1.0
1.1
1.2
d(Nregions/N1model) / d
Treg
oblate triaxial prolate
= 6.5 - log10(Tvir) = 3.5
= 12.0 - log10(Tvir) = 4.0
= 30 - log10(Tvir) = 4.69897
= 40 - log10(Tvir) = 4.69897
= 55 - log10(Tvir) = 4.69897
= 100 - log10(Tvir) = 4.69897
= 300 - log10(Tvir) = 4.69897
= 55.0 - log10(Tvir) = 5.0
= 150.0 - log10(Tvir) = 5.4
Fig. 7. Probability distribution functions of the triaxiality parameter of
the reionization patches of every model (top panel). The bottom pannel
represents the same PDFs but each one of them is divided by one particular model (the one with ζ = 30 and log10(Tvir) = 4.69897). On the
two panels, all the patches of each realisation for one specific model are
accumulated.
that many features in the 21-cm signal only converges at larger
scales (200 Mpc/h at least, Iliev et al. (2014)) and further investigations will be conducted later on to see how it translates to our
reionization patches.
4. Orientation of the reionization patches with
respect to the gas filaments
This section deals with the orientation of the reionization patches
with respect to matter. The directions of the main axis of the gas
filaments and the patches they are located in are compared using
the eigenvectors of their inertial tensors, computed as mentioned
in Sect. 2.4. To do so, the cosine of the angle between those
directions is computed as follows:
cos(hzreion, δi) = cos(hΨzreion,3, Ψδ,3i), (6)
=
Ψzreion,3 · Ψδ,3
||Ψzreion,3||||Ψδ,3||
, (7)
Ψzreion,3 and Ψδ,3 are the eigenvectors corresponding to the largest
eigenvalue of the zreion patches and the filaments respectively.
Article number, page 6 of 13
Emilie Thélie et al.: A first look at the topology of reionization redshifts in models of the Epoch of the Reionization
10
2 10
3 10
4 10
5
Vregion [h
3 Mpc
3
]
10
14
10
13
10
12
10
11
10
10
d
Nregions/d
Vregion [V
1
box h
3 M
p
c
3
]
= 6.5 - log10(Tvir) = 3.5
= 12.0 - log10(Tvir) = 4.0
= 30 - log10(Tvir) = 4.69897
= 40 - log10(Tvir) = 4.69897
= 55 - log10(Tvir) = 4.69897
= 100 - log10(Tvir) = 4.69897
= 300 - log10(Tvir) = 4.69897
= 55.0 - log10(Tvir) = 5.0
= 150.0 - log10(Tvir) = 5.4
Fig. 8. Probability distribution functions of the volume of segmentations
patches for each physical model mentioned in Table 1. Here, all the
patches of each realisation for one specific model are accumulated.
4.1. Emitting halos with different mass range and ionizing
efficiency (SRH set)
We first look at the probability distribution functions of the
patch-filament alignment for every model of the SRH set, which
are shown on Fig. 9. For each model, the cosines of all of their
patches are accumulated in order to improve the statistics of
the result. The top panel shows that the majority of reionization patches are rather aligned with their gas filament. Besides,
there does not seem to be any great difference between the different models of this set. The bottom panel, showing PDFs normalised to the ζ = 30 and Tvir = 5 × 104 K fiducial model, lets
us see the slight variations between the five models. The models
are well ordered in the cos(hzreion, δi) ∼ 1 regime: simulations
with the smaller emitting halos have more patches aligned with
the density. Conversely, models with strong emitters have more
frequently perpendicular configurations between matter and radiation, albeit still dominated by aligned situations. The gray
curve in the top panel corresponds to the model with ζ = 30
and Tvir = 5 × 104 K, for which each filament has been rotated
with a randomly chosen angle for safety checks. In that case, filaments have now random orientations, which means that their
orientation compared to the radiations are also random. Indeed,
one can see that the PDF of this test is rather flat, depicting the
expected random behaviour.
We now know that the majority of reionization patches are
aligned with their filament. In Sect. 2.4, we have shown that
the majority of reionization patches have a prolate shape. So,
is there any correlation between those behaviours? Figure 10 is
a 2D distribution of the triaxiality parameter versus the cosine
of angles between the radiations and filaments for the fiducial
model (ζ = 30 and log10(Tvir) = 4.69897). One can see that there
is indeed a correlation between the shape and the orientation of
zreion patches: they are generally prolate and aligned with the filaments. Note that this distribution is very similar for every other
model (which are not shown here). Therefore, in our simulations
there is a clear regime of prolate-aligned reionization patches
(see the top-right region with T ≥
2
3
and cos(hzreion, δi) ≥ 0.5 of
the T vs. cos(hzreion, δi) space, where there is 46.6% of the total
number of patches). There are also other types of patches, even if
there are rarer. For example, the opposite of the prolate-aligned
0.0 0.2 0.4 0.6 0.8 1.0
cos( zreion, )
1.0
1.5
2.0
2.5
3.0
d(Nregions/N) / d
c
o
s( zreion, )
= 6.5 - log10(Tvir) = 3.5
= 12.0 - log10(Tvir) = 4.0
= 30 - log10(Tvir) = 4.69897
= 55.0 - log10(Tvir) = 5.0
= 150.0 - log10(Tvir) = 5.4
= 30 - log10(Tvir) = 4.69897 with fil rotation
0.0 0.2 0.4 0.6 0.8 1.0
cos( zreion, )
0.85
0.90
0.95
1.00
1.05
1.10
1.15
d(Nregions/N1model) / d
c
o
s( zreion, )
= 6.5 - log10(Tvir) = 3.5
= 12.0 - log10(Tvir) = 4.0
= 30 - log10(Tvir) = 4.69897
= 55.0 - log10(Tvir) = 5.0
= 150.0 - log10(Tvir) = 5.4
Fig. 9. On the top panel, there are the probability distribution functions
of the cosine of the angle between the reionization patches and their corresponding filaments (as explained in Sect. 2.4). On the bottom panel,
the same PDFs are shown but they are divided by the one of the model
with ζ = 30 and log10(Tvir) = 4.69897. Each model varying ζ and Tvir
at the same time are represented here, accumulating all patches of their
101 realisations on both panels. Besides, on the top panel, the model
with ζ = 30 and log10(Tvir) = 4.69897 is also represented (in gray) with
a rotation of filaments in order to have a comparison with total randomness.
patches are the oblate-perpendicular patches to the filaments (see
the bottom-left region with T ≤
1
3
and cos(hzreion, δi) ≤ 0.5 of
the T vs. cos(hzreion, δi) space): there are only a few of them
(2.36%) and they are in fact patches with "butterfly" shapes. Figure 11 shows those two kinds of patches: the pink cells belong
with the filament and the rainbow-colored ones belong with the
reionization patches. On the top panel, there is an example of
a prolate-aligned region, where one can clearly see its prolate
shape and that the reionization patch follows well the direction of
the filament. On the bottom panel, the patch looks like a butterfly
thanks to the two "wings" surrounding the filament: it is easier
for the radiation to escape perpendicularly to the filament, as
these directions are less dense. Another interesting feature with
that "butterfly" patch is that one can clearly see that regions close
to the filaments have been reionized earlier, while the reionization redshift decreases as the distance to the filaments increases.
The same behaviour is observed on the prolate-aligned region
Article number, page 7 of 13
A&A proofs: manuscript no. aanda
0.0 0.2 0.4 0.6 0.8 1.0
cos( zreion, )
0.0
0.2
0.4
0.6
0.8
1.0
T
oblate
triaxial
prolate
= 30 - log10(Tvir) = 4.69897
0.000
0.001
0.002
0.003
0.004
0.005
0.006
0.007
lo
g(Nregions/Ntot)
Fig. 10. 2D histogram representing the logarithm of the ratio of the
number of patches to the total number of patches of the simulation in
bins of triaxiality parameter and cosine of the angle between reionization patches and filaments for the fiducial model (the one with ζ = 30
and log10(Tvir) = 4.69897). The white full lines are the isocontours of
the histogram. The coloured cells of this histogram correspond to nonzero values, and the white cells to zero values.
of the top panel but in a less impressive manner. With these examples, one can clearly see that the sources are located within
the filaments or very close to them and it leads to an inside-out
scenario of the Reionization.
Regarding the difference between "fiber-like" and "butterfly" shapes, we believe that it originates from the population of
sources within a given patch. Fiber-like regions could include
a collection of radiation sources "beaded" along the filaments,
with similar properties in terms of ignition time, emissivity and
environment: in such situations, the source, located at the reionization peak of a given patch (i.e. the patch seed) is not exceptional compared to close-by sources within the same region. The
differences in reionization times values and gradients created by
these sources are not sufficient to let DisPerSE segments a region into small individual reionization patches and it rather produces extended patches along filaments. On the other hand, butterfly patches could be the mark of a patch dominated by its
seed source (because it is isolated and/or brighter than other local emitters), that singlehandedly drives the propagation of ionization fronts from the very beginning, preferentially along the
path of least resistance, perpendicularly to filaments. But clearly,
the latter geometry is sub-dominant in our models, a trend that
can be accentuated by the late reionization scenario of the SRH
dataset (compared to e.g the DRH models): at late times a greater
number of locations are susceptible to host sources and patches
are rarely dominated by a single source. It should be noted that
an increase in both Tvir and ζ can boost the propagation of ionization fronts, cancelling local small variations of reionization times
and gradients around sources along filaments. It would lead to
larger coherent patches and we therefore expect a decrease in the
number of fibre-like regions in such cases, as measured indeed
in the SRH set.
4.2. Different Reionization histories
We now focus on the simulations of the DRH set (those varying only ζ for the fiducial Tvir). Changing ζ allows us to study
Fig. 11. Examples of reionization patches and their corresponding filament extracted from the segmentations of our simulations: on the top
panel, there is a prolate-aligned region, and on the bottom panel, there
is an oblate-perpendicular or "butterfly" region. In shades of pink, one
can see filaments, and in rainbow colors, the zreion region. The redder
the region is, the earlier it has reionized. On the contrary, the bluer it is,
the later it has reionized.
the impact of different histories of Reionization and different halos ionizing efficiencies. Figure 12 shows the PDFs of the cosine of the angle between their reionization patches and their
filaments. At first sight (top panel of this Figure), there is no
significant differences between the five models, always having a
majority of aligned patches with their filaments. Looking at ratios of PDFs with the fiducial model, a weak trend can be noted:
the higher ζ, the less the patches are aligned to the filaments and
there is a slight increase in the number of perpendicular "butterfly" patches. It would be consistent with the above hypothesis
regarding the origins of the different geometries: DRH models
with large ζ (while keeping Tvir constant) attribute strong emissivities to the first and rare sources that seed the patches, and
let them extend their radiative influence perpendicularly to the
filaments at early times.
5. The impact of the persistence parameter
In the previously mentioned results, all the segmentations of the
density and the reionization redshift fields have been obtained
using DisPerSE with a fixed value of the persistence threshold. In this section, we propose a brief comparison of the major results shown earlier but with different persistence values.
This comparison is only done on the fiducial 21cmFAST model
(ζ = 30 and Tvir = 5 × 104 K) for the sake of brevity, but it is
Article number, page 8 of 13
Emilie Thélie et al.: A first look at the topology of reionization redshifts in models of the Epoch of the Reionization
0.0 0.2 0.4 0.6 0.8 1.0
cos( zreion, )
1.0
1.5
2.0
2.5
3.0
d(Nregions/N) / d
c
o
s( zreion, )
= 30 - log10(Tvir) = 4.69897
= 40 - log10(Tvir) = 4.69897
= 55 - log10(Tvir) = 4.69897
= 100 - log10(Tvir) = 4.69897
= 300 - log10(Tvir) = 4.69897
= 30 - log10(Tvir) = 4.69897
0.0 0.2 0.4 0.6 0.8 1.0
cos( zreion, )
0.85
0.90
0.95
1.00
1.05
1.10
1.15
1.20
d(Nregions/N1model) / d
c
o
s( zreion, )
= 30 - log10(Tvir) = 4.69897
= 40 - log10(Tvir) = 4.69897
= 55 - log10(Tvir) = 4.69897
= 100 - log10(Tvir) = 4.69897
= 300 - log10(Tvir) = 4.69897
Fig. 12. On the top panel, there are the probability distribution functions of the cosine of the angle between the reionization patches and
their corresponding filaments (as explained in Sect. 2.4). On the bottom
panel, the same PDFs are shown but they are divided by the one of the
model with ζ = 30 and log10(Tvir) = 4.69897. Each model varying only
ζ are represented here, accumulating all patches of their 101 realisations
on both panels. Besides, on the top panel, the model with ζ = 30 and
log10(Tvir) = 4.69897 is also represented (in gray) with a rotation of
filaments in order to have a comparison with total randomness.
very likely that the conclusions remain the same for every other
model.
The segmentations of the density and redshift of reionization
fields (of the fiducial 21cmFAST model) are therefore computed
with DisPerSE using four other persistence values, which are
0.625−σ, 0.75−σ, 0.875−σ and 1−σ. Figure 13 shows the accumulated numbers of reionization patches found in those fields
for every one of the 101 realisations. One can see that the larger
the persistence, the less there are patches as expected since critical points are more easily merged. It means that in the resulting segmentations with those larger persistences, there is a
lower number of critical points, explaining the lower number of
patches. This behaviour directly impacts the volume of the reionization patches for which the probability distribution functions
are shown on Fig. 15. The correlation of the number of patches
and their volume is clearly visible here: the larger the persistence
0.5
0.625
0.75
0.875
1
Persistence for simulations with = 30 and log10(Tvir) = 4.69897
0
20000
40000
60000
80000
100000
120000
Nregions
8.11E+04
6.29E+04
4.95E+04
3.92E+04
3.12E+04
Fig. 13. Number of patches in the fiducial model (ζ = 30 and Tvir =
5 × 104 K) that are detected using DisPerSE with different persistence
levels. For each one of them, one adds the patches numbers of every
realisation.
is, the larger the volume of patches is and the fewer the patches
should be since the total volume is conserved.
It should be noted that persistence is related to percolation.
For instance, on the 1D representation of the persistence of Fig.
3, we see that, after applying a persistence threshold, the leftmost maximum (reionization seed in our case) "disappears" and
will be associated to the other one. Small persistence applied
on the reionization redshift maps allow less prominent and more
numerous patches to be taken into account in the final segmentations. Conversely, large persistence values favour the merging of
patches by DisPerSE, as sketched in Fig. 14. The persistence applied on the reionization redshift maps can thus be seen as a relative measure of the different timings of creation of two patches
and it can therefore follow the percolation process. We could in
principle retrieve the relative progression of the fusion of ionized bubbles (regardless of the time), giving us a complementary
view of the time progression of the percolation that is the subject of many studies in the literature (see e.g. Chen et al. (2019);
Giri et al. (2019); Gorce & Pritchard (2019); Giri & Mellema
(2020)). Indeed, Elbers & van de Weygaert (2019) point out that
the persistence can follow the lifetime of a topological feature
and then the creation and evolution of structures, that is the percolation process. They have shown with simple models that they
can follow the stages of Reionization and know in which stage
the bubbles are by coupling the persistence homology with the
Betti numbers.
Now, computing the triaxiality parameter for every new persistence, one can plot the PDFs shown on the top panel of Fig.
16. Generally, all the segmentations with the different persistences have the same behaviour: a majority of prolate reionization patches. But looking at the detailed ratios with the 0.5−σ
curves (bottom panel of the same Figure), one can distinguish a
trend with increasing persistences: the larger the persistence, the
more there are prolate patches. The percolation process therefore
favours the merging of patches along filaments and promotes
prolate-aligned configurations, with "beaded" patches along filaments, as sketched again in Fig. 14. Again, our study of the
persistence is reminiscent of the process detailed by Chen et al.
(2019) where small ionized bubbles grow during their "Ionized
Bubble" stage and merge to form the bigger and fibre-like regions during the "Ionized Fibre" stage. Changing the persistence
parameter allows us to retrieve a similar behaviour in our segmentations.
Nevertheless, our segmentations appear to be robust to the
changes in persistence, and the main conclusions that have
Article number, page 9 of 13
A&A proofs: manuscript no. aanda
filament filament filament
Regions of
influence
Regions of
influence
Region of
influence
Ionization
sources
Increasing the
persistence
Increasing the
persistence
Fig. 14. 2D illustration of the percolation process using the persistences. A matter filament is represented in blue with many ionization
seeds (in red) within it. Those seeds create their patch of radiative influence (shown in orange), and when the persistence increases (from left
to right), smaller patches merge to form bigger ones.
10
2 10
3 10
4
Vregion [h
3 Mpc
3
]
10
14
10
13
10
12
10
11
10
10
d
Nregions/d
Vregion [V
1
box h
3 M
p
c
3
]
= 30 - log10(Tvir) = 4.69897 - p=0.5
= 30 - log10(Tvir) = 4.69897 - p=0.625
= 30 - log10(Tvir) = 4.69897 - p=0.75
= 30 - log10(Tvir) = 4.69897 - p=0.875
= 30 - log10(Tvir) = 4.69897 - p=1
Fig. 15. Probability distribution functions of the volume of segmentations patches for the fiducial model (ζ = 30 and Tvir = 5 × 104 K) with
the different persistences used in DisPerSE. Here, all the patches of
each realisation for one specific model are accumulated.
been mentioned in previous sections. are unchanged. Indeed, the
shape of the reionization patches (see Fig. 16) remains very similar and the orientation of the patches with respect to the filaments
is almost unchanged too, as one can see on Fig. 17.
6. Comparison with EMMA simulations
We now compare the topology of EoR simulations obtained with
the semi-numerical code 21cmFAST to that coming from the
cosmological simulation code EMMA (Electromagnétisme et Mécanique sur Maille Adaptative, Aubert et al. (2015)). EMMA is
an adaptive mesh refinement (AMR) code that couples radiative
transfer and hydrodynamics, and in which the light is described
as a fluid (resolved using the moment-based M1 approximation,
Aubert & Teyssier (2008)).
The EMMA simulations set on which we work here is composed of two simulations with cosmology given by Planck Collaboration et al. (2020), with no AMR and no reduced speed of
light (see Gillet et al. (2021) for more information on the simulations). The difference between the two simulations is the mass
resolution of the stellar particles: 107 M for the one labelled
as EMMA "Mslow" and 108 M for the other one. As detailed in
Gillet et al. (2021), stellar particles are converted from gas according to a Poissonian process. Cells that will convert to stars
0.0 0.2 0.4 0.6 0.8 1.0
Treg
10
2
10
1
10
0
d
Nregions / d
Treg
oblate triaxial prolate
= 30 - log10(Tvir) = 4.69897 - p=0.5
= 30 - log10(Tvir) = 4.69897 - p=0.625
= 30 - log10(Tvir) = 4.69897 - p=0.75
= 30 - log10(Tvir) = 4.69897 - p=0.875
= 30 - log10(Tvir) = 4.69897 - p=1
0.0 0.2 0.4 0.6 0.8 1.0
Treg
0.85
0.90
0.95
1.00
1.05
1.10
1.15
d(Nregions/N1model) / d
Treg
oblate triaxial prolate
= 30 - log10(Tvir) = 4.69897 - p=0.5
= 30 - log10(Tvir) = 4.69897 - p=0.625
= 30 - log10(Tvir) = 4.69897 - p=0.75
= 30 - log10(Tvir) = 4.69897 - p=0.875
= 30 - log10(Tvir) = 4.69897 - p=1
Fig. 16. Probability distribution functions of the triaxiality parameter
for the fiducial model (ζ = 30 and Tvir = 5 × 104 K) with the different
persistences used in DisPerSE (top panel). The bottom pannel represents the same PDFs but each one of them is divided by one particular
model (the fiducial one with the persistence being 0.5 − σ). On the two
panels, all the patches of each realisation for one specific model are
accumulated.
an amount of gas only slightly larger than the stellar mass will
naturally lead to a stochastic star formation process. Conversely,
if the same amount of gas is much larger than the stellar mass
particle, it will induce a steady stream of particles. As a consequence the EMMA "Mslow" model presents a diffuse population
of stars, whereas the other one exhibits a stellar biased population focused on the densest cells. For these two simulations, the
boxes have 5123
cells for 5123
cMpc3
/h
3
. We have then cut those
boxes in 64 sub-boxes of 1283
cells and 1283
cMpc3
/h
3
, creating 64 "realisations" of the two EMMA models. The resolution of
those sub-boxes is the same than the one of the 21cmFAST simulations. Comparisons with the 21cmFAST models are made with
64 realisations of each 21cmFAST simulation for consistency.
On Fig. 18, one can see the ionized volume fractions of every
simulation mentioned in this study. The EMMA ones are fully ionized approximately at the same time as the 21cmFAST ones. With
EMMA, however, the reionization starts later and is more abrupt,
which could be explained by the fact that EMMA simulations have
Article number, page 10 of 13
Emilie Thélie et al.: A first look at the topology of reionization redshifts in models of the Epoch of the Reionization
0.0 0.2 0.4 0.6 0.8 1.0
cos( zreion, )
1.0
1.5
2.0
2.5
3.0
d(Nregions/N) / d
c
o
s( zreion, )
= 30 - log10(Tvir) = 4.69897 - p=0.5
= 30 - log10(Tvir) = 4.69897 - p=0.625
= 30 - log10(Tvir) = 4.69897 - p=0.75
= 30 - log10(Tvir) = 4.69897 - p=0.875
= 30 - log10(Tvir) = 4.69897 - p=1
= 30 - log10(Tvir) = 4.69897 - p=0.5 with fil rotation
Fig. 17. Probability distribution functions of the cosine of the angle
between the reionization patches and their corresponding filaments (as
explained in Sect. 2.4) of the fiducial model (ζ = 30 and Tvir = 5 ×
104 K) with the different persistences used in DisPerSE, accumulating
all patches of every realisation. Besides, the model with the 0.5 − σ is
also represented (in gray) with a rotation of filaments in order to have a
comparison with total randomness.
larger volumes compared to the 21cmFAST ones, with greater
voids and larger halos.
Again, before using DisPerSE on the EMMA fields, the same
kind of transformations as mentioned in Sect. 2.3 are applied on
each sub-box, using the means and the standard deviations of
the 5123
cMpc3
/h
3 boxes instead of those of each sub-grid. Doing so, we take into account the cosmic variance of the whole
box. After having obtained the segmentations with DisPerSE
with the same persistence used for all the 21cmFAST simulations
(0.5−σ), one can compute the distribution of volumes of patches.
It is shown in Fig. 19 for every EMMA and 21cmFAST simulations accumulating 64 realisations for each one of them. The
EMMA simulations have smaller patches and a greater number of
them than the 21cmFAST simulations. The EMMA model with the
massive, 108M, stellar particles is significantly different from
the 21cmFAST simulations: the patch size distribution is clearly
shifted to smaller volumes with a large number of small patches.
Meanwhile, the EMMA "Mslow" model with the less massive,
107M, stellar particles is more alike the 21cmFAST models: the
more diffuse source distribution, allowed by such settings, manage to recover topological features similar to 21cmFAST models
(in which all locations is a potential source of radiation with its
own distribution of emitting halos).
The tensors and main directions of the reionization patches
and filaments of the EMMA simulations are computed, and allow
us to compare the direction of the propagation of radiation with
respect to the filament. The top panel of Fig. 20 shows the distributions of the cosine of the angle between those directions for
the EMMA and the 21cmFAST simulations. There is an alignment
of patches and gas filaments in the EMMA simulation similar to the
21cmFAST models, with the EMMA "Mslow" being slightly more
aligned. The bottom panel of Fig. 20 shows the ratio of each
PDFs of cosines with the fiducial 21cmFAST model and again
the EMMA "Mslow" shows very similar PDFs to the 21cmFAST
models, which implies that it is possible to recover the same
kind of behaviour than semi-analytical simulations with a fullynumerical code even if the reionization occurs differently. Con4 6 8 10 12 14 16
z
0.0
0.2
0.4
0.6
0.8
1.0
x
HII
21cmFAST - = 6.5 - log10(Tvir) = 3.5
21cmFAST - = 12.0 - log10(Tvir) = 4.0
21cmFAST - = 30 - log10(Tvir) = 4.69897
21cmFAST - = 40 - log10(Tvir) = 4.69897
21cmFAST - = 55 - log10(Tvir) = 4.69897
21cmFAST - = 100 - log10(Tvir) = 4.69897
21cmFAST - = 300 - log10(Tvir) = 4.69897
21cmFAST - = 55.0 - log10(Tvir) = 5.0
21cmFAST - = 150.0 - log10(Tvir) = 5.4
EMMA
EMMA Mslow
Fig. 18. Ionized volume fraction of all the 21cmFAST simulations and
the two EMMA simulations having different models, each one of them
averaged on 64 realisations.
10
2 10
3 10
4 10
5
Vregion [h
3 Mpc
3
]
10
15
10
14
10
13
10
12
10
11
10
10
d
Nregions/d
Vregion [V
1
box h
3 M
p
c
3
]
21cmFAST - = 6.5 - log10(Tvir) = 3.5
21cmFAST - = 12.0 - log10(Tvir) = 4.0
21cmFAST - = 30 - log10(Tvir) = 4.69897
21cmFAST - = 40 - log10(Tvir) = 4.69897
21cmFAST - = 55 - log10(Tvir) = 4.69897
21cmFAST - = 100 - log10(Tvir) = 4.69897
21cmFAST - = 300 - log10(Tvir) = 4.69897
21cmFAST - = 55.0 - log10(Tvir) = 5.0
21cmFAST - = 150.0 - log10(Tvir) = 5.4
EMMA
EMMA Mslow
Fig. 19. Probability distribution functions of the volume of segmentations patches for every 21cmFAST and EMMA simulation. Here, all the
patches of each 64 realisations for one specific model are accumulated.
versely, the EMMA model with massive, 108M, stellar particle
presents quite a different picture in terms of alignments. The
scarce, stochastic and biased distribution of sources in this models leads to much more perpendicular patches than all the other
models. While this model is in reasonable agreement in terms of
reionization history, its topology ends up being quite different:
it emphasises how models that present some reasonable global
agreements can end up being vastly different in terms of topology as soon as the details of for example the source models are
not equivalent. The higher star formation stochasticity and the
more biased distribution of sources lead to trends similar to the
larger virial temperatures in the 21cmFAST simulations, with isolated reionization seeds that dominate more their environment.
As for the shape of the reionization patches in the EMMA simulations set, they are also rather prolate in both simulations as in the
21cmFAST simulations and no significant difference between the
models have been found (not shown here).
Article number, page 11 of 13
A&A proofs: manuscript no. aanda
0.0 0.2 0.4 0.6 0.8 1.0
cos( zreion, )
1.0
1.5
2.0
2.5
3.0
d(Nregions/N) / d
c
o
s( zreion, )
21cmFAST - = 6.5 - log10(Tvir) = 3.5
21cmFAST - = 12.0 - log10(Tvir) = 4.0
21cmFAST - = 30 - log10(Tvir) = 4.69897
21cmFAST - = 40 - log10(Tvir) = 4.69897
21cmFAST - = 55 - log10(Tvir) = 4.69897
21cmFAST - = 100 - log10(Tvir) = 4.69897
21cmFAST - = 300 - log10(Tvir) = 4.69897
21cmFAST - = 55.0 - log10(Tvir) = 5.0
21cmFAST - = 150.0 - log10(Tvir) = 5.4
EMMA
EMMA Mslow
0.0 0.2 0.4 0.6 0.8 1.0
cos( zreion, )
0.8
0.9
1.0
1.1
1.2
d(Nregions/N1model) / d
c
o
s( zreion, )
21cmFAST - = 6.5 - log10(Tvir) = 3.5
21cmFAST - = 12.0 - log10(Tvir) = 4.0
21cmFAST - = 30 - log10(Tvir) = 4.69897
21cmFAST - = 40 - log10(Tvir) = 4.69897
21cmFAST - = 55 - log10(Tvir) = 4.69897
21cmFAST - = 100 - log10(Tvir) = 4.69897
21cmFAST - = 300 - log10(Tvir) = 4.69897
21cmFAST - = 55.0 - log10(Tvir) = 5.0
21cmFAST - = 150.0 - log10(Tvir) = 5.4
EMMA
EMMA Mslow
Fig. 20. On the top panel, there are the probability distribution functions
of the cosine of the angle between the reionization patches and their corresponding filaments (as explained in Sect. 2.4). On the bottom panel,
the same PDFs are shown but they are divided by the one of the model
with ζ = 30 and log10(Tvir) = 4.69897. Each 21cmFAST model is represented here, alongside with the two EMMA simulations, accumulating all
patches of 64 realisations on both panels.
7. Conclusions
In this study, we have analysed the topological structures extracted from different EoR models made with the 21cmFAST
semi-analytical code and the EMMA cosmological simulation
code. For that purpose, we have used the reionization redshift
and gas density fields. The reionization redshift field corresponds
to the time when the gas has reionized, and contains spatial and
temporal information on the physical processes during the EoR.
To extract the topological information, we have used DisPerSE,
that applies concepts of the Morse theory, on the density field to
get the filaments of matter and on the reionization redshift field
to segment it into reionization patches coming from the same
seed of local reionization.
In the 21cmFAST models, the size distributions of the reionization patches show us that they have an average radius of 10
cMpc/h quantifying the typical extent of the radiative influence
of the seeds of reionization. In general increasing the virial temperature and the ionizing efficiency of halos decreases the number of patches and makes them larger, extending the reach of the
radiative influence of the seeds of local reionization.
Using the inertial tensors of the reionization patches and density filaments, one could extract their shape and orientation. We
found that the reionization patches are statistically prolate and
aligned with the local gas filaments. Radiation escapes from
sources beaded along the gas filament to reach the zones that
reionize the latest (typically, the voids) in an inside-out manner.
A minority of patches have the opposite behaviour with a "butterfly" shape, that are oblate patches with radiations escaping
perpendicularly to the local filaments. We believe that the difference arises from the properties of sources within the patches:
if the initial source that defines a reionization patch is locally
dominant in terms of photons output, butterflies shape can appear, whereas if the initial source is only the first of a collection
of rather similar close-by emitters, patches end up aligned with
the local distribution of matter. We note that the dominant status
of a source can depend on many factors (intrinsic emission, escape fraction, density and configuration of local absorbers) and
is therefore likely to be resolution and/or model dependent. Our
results, obtained at rather low resolution (1.483
cMpc3
), should
be revisited later on, for instance at higher resolution.
Comparisons of the 21cmFAST segmentations with the ones
obtained from EMMA simulations showed that EMMA simulations
can provide results similar to the semi-analytical predictions in
terms of patches properties (volume, number) and relative orientations to the filaments of matter. We also find that EMMA simulations with increased bias and stochasticity for star formation can
also lead to quite different topologies on the same criteria, even
though they present similar reionization histories.
These results appear to be robust when changing the persistence parameter with DisPerSE. As the persistence increases
and patches are merged, the latter gets larger and more prolate. It
provides an insight on the percolation process of our EoR models, directly from a single reionization map. We find that during
the first stages of the Reionization, isolated ionized bubbles appear and merge with time in order to form larger and fibre-like
ionized bubbles (Chen et al. 2019). This subject could be further
investigated, as it is complementary to standard percolation studies based on sequences of snapshots of ionized fractions maps.
To sum up, the reionization redshift field contains a lot of
spatial and temporal information, and is found to be quite useful
in the current topological framework. In addition, making statistical analyses with this field is quite practical since it requires
to only extract one zreion field from each simulation. We believe
that we only skimmed through the potential of the approach developed here. We already mention the possibilities offered by the
persistence parameter. We could also investigate the halo properties in relation to their host reionization patches. Moreover, we
could work on smaller scales and see if the study of the patches
geometry (size, shape, orientation) could inform us about the
ways radiations escape from galaxies, how far they can influence their environment and even about the time evolution/duty
cycles of the photons production (see e.g. Deparis et al. (2019)).
However, such studies on galaxies or halos are not possible at the
resolution discussed here and ideally would be conducted with
models with CoDa-like characteristics (Ocvirk et al. 2016). Finally the zreion field is not a direct observable, and similar analyses could be directly done on the topology of 21-cm maps or
lightcones. These geometrical studies may reveal a way to relate
these observations to the timing of the reionization process.
Article number, page 12 of 13
Emilie Thélie et al.: A first look at the topology of reionization redshifts in models of the Epoch of the Reionization
