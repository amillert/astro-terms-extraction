Correlating galaxy shapes and initial conditions: observational study
We find that galaxy angular momenta determined from shapes of spiral galaxies correlate with
the initial tidal field in the galaxy’s neighborhood. Explicitly, we find that the galaxies tend to
be preferentially face on (edge on) oriented when the major (minor) axis of the initial tidal field is
aligned with the line of sight. Because tidal-torque theory predicts vanishing of this kind of signal, the
observed correlation suggests non-linear origin. This correlation is statistically significant even after
considering the number of observables investigated. Our result provides motivation for considering
galaxy shape information in the efforts aiming to reconstruct initial conditions in the Universe.
I. INTRODUCTION
Galaxy surveys have been instrumental in enhancing
our understanding of the Universe [1–4]. Beyond the
traditional analyses, it is useful to think about how to
extract additional information from the large number of
galaxies that will be discovered in the following years
[5, 6].
One of the suggestions has been using measurements
of galaxy angular momenta, that can extend our understanding of physics at megaparsec scales [7–9]. Such measurements can aid with reconstruction of the initial conditions (ICs) in the Universe [7, 8] and help to constrain
neutrino masses [10], primordial gravitational waves [11],
primordial non-Gaussianity [12] and chirality violations
in the early Universe [9]. Better knowledge of initial matter distribution in the local volume would also aid studies
of galaxy formation.
In our current understanding, the dark matter haloes
acquire angular momenta from the inhomogeneous tidal
field that torques the non-spherical protohalo early on
[13–17]. At late times, interactions with the nearby large
scale structure notably complicate the picture [16–37].
Despite these late time effects, it turns out that the
direction of the halo angular momentum retains a significant amount of the initial information [9]. Naturally,
we can not directly measure angular momenta of dark
matter haloes. Fortunately, spins*1 of galaxies tend to be
correlated with spins of their dark matter haloes [38, 39],
and so there is a potential to use measurements of galaxy
spins to probe the initial conditions in the local Universe.
It seems that the amplitude of the dark matter halo’s
angular momentum also retains information about the
*1 As a shorthand, here and in what follows we use “spin” to specifically only refer to the direction of the angular momentum of a
halo/galaxy, ignoring its amplitude.
initial conditions [40] (but see [16, 39]). However, in this
work we only consider the angular momenta directions,
especially given the experimental cost involved in determining the amplitudes of galaxy angular momenta.
The prospect that measurements of galaxy spins might
help with the reconstruction of the initial conditions in
the Universe requires an observational verification. We
made a first step in this direction in [41], where we found
a correlation between the galaxy spins of a sample of
about 15000 galaxies and initial conditions reconstructed
from positions of a larger sample of galaxies [42]. Unfortunately, due to the limited number of galaxies we could
only confirm this correlation with a ∼ 3σ confidence. To
achieve this result, we combined a set of galaxies for
which integral field spectroscopy data is available with
a set of spiral galaxies with known senses of rotation of
their spiral arms.
At least in principle we have access to a significantly
larger dataset of galaxy spins. Assuming that each spiral
galaxy forms a thin disk with its spin pointing perpendicularly to the plane of the disk, we can utilize shape
measurements of spiral galaxies to determine their spins
up to a so-called four-fold degeneracy (see below) [7].
Shape measurements of spiral galaxies, as a proxy for
their spins, are thus potentially useable as an additional
handle on the initial conditions of the Universe. In this
paper we investigate to what extent such a proposition
is viable by studying correlations between galaxy spin
components determined solely from galaxy shapes and
observables derived from the initial density field as measured using a traditional reconstruction technique. In
contrast with [41], we trade a somewhat lower signal per
galaxy (due to the four-fold degeneracy) for a larger number of galaxies. Unlike the previous studies such as [43],
we study correlations of galaxy shapes with observables
derived from initial, not late time, density field.
This paper is organized as follows: In § II we describe how to determine galaxy spins from the galaxy
shape measurements and discuss the four-fold degenerarXiv:2111.12578v1 [astro-ph.CO] 24 Nov 2021
2
acy. Then we explain how we quantify correlations between galaxy spins and the initial conditions and list the
observables built from the initial conditions we consider
in this work. In § III we introduce the data used and in
§ IV we present our results. We conclude with discussion
in § V.
We use indices i, j, k, l to denote components of vectors
and tensors in three dimensions.
II. THEORY
In this section we introduce the thin disk approximation that we use to connect measurements of galaxy
shapes and their angular momenta. Then we describe
how we quantify correlations between galaxy spins and
various observables built from the initial conditions, before listing all such observables considered in this work.
A. Spins from shapes
Measuring the full 3D vector of galaxy angular momentum requires integral field spectroscopy, which is experimentally costly and can at the present only be obtained
for several thousands of galaxies [44, 45]. Using an approximation in which spiral galaxies are considered to be
thin disks allows us to use images of spiral galaxies to
infer information about their angular momenta [23, 43].
Currently, tens of thousands of such images are available.
In this thin-disk approximation, matter is assumed to
be circling around the galaxy center in the plane of the
disk, implying that the galaxy angular momentum vector
is perpendicular to the plane of the galaxy. This plane
can be, up to a two-fold degeneracy, determined from the
position angle α and axis ratio R of the galaxy image.
Additional two-fold degeneracy then arises because from
α and R alone we are unable to determine whether the
galaxy spin points towards or away from the observer.
The unit spin vector of such a galaxy in the local spherical coordinate frame (Lr, Lθ, Lφ) can be determined
through [46]
|Lr| = R
Lθ/Lφ = tan α, (1)
where the four-fold degeneracy prevents us from determining the signs of Lr and Lθ (and thus Lφ) from the
galaxy image alone.
In the equatorial Cartesian coordinates, the unit spin
vector can be then determined from the right ascension
and declination of the galaxy through [43]
L~ = L~ R + L~
T , (2)
where we defined
L~ R ∝ Lr (sin θ cos φ,sin θ sin φ, cos θ)
L~
T ∝ Lθ (cos θ cos φ, cos θ sin φ, − sin θ)
+Lφ (− sin φ, cos φ, 0) (3)
and θ = π/2−DEC and φ = RA. Because of the four-fold
degeneracy, signs of L~ R,T are ambiguous. Notice that in
general neither of the vectors L~ R,T has unit norm.
By default we consider spiral galaxies to be infinitely
thin disks and use (1). To test for systematic effect of this
assumption, we also consider non-zero intrinsic flatness p
of the spiral galaxies, where we replace R in (1) with
R → s
max (R2 − p
2, 0)
1 − p
2
. (4)
Experimentally, p of spiral galaxies has been measured
to be ∼ 0.1 − 0.2 [47].
B. Quantifying correlations
In this section we give an overview of how we quantify correlations between measurements of galaxy spins
as represented by L~ R,T and the initial conditions. In all
cases, the initial conditions are represented by either a
vector Vi or a rank-two tensor Mij constructed from the
second derivatives of the initial density ρini, gravitational
potential φini, or both.
Considering first the rank-two variables of the form
Mij , we can form three scalar combinations
LRMLR ≡
X
ij
LRiMijLRj (5)
LTMLT ≡
X
ij
LT iMijLT j (6)
LTMLR ≡
X
ij
LT iMijLRj , (7)
where for future convenience we suppressed the index
structure on the left hand side. Given the four-fold degeneracy in determining L~
T and L~ R, the last combination
can not be evaluated using the shape data alone. On the
other hand, LRMLR and LTMLT are invariant with respect to this degeneracy and can be used to study the
correlations between galaxy spins and initial conditions.
With vector variables Vi the situation is slightly more
complicated, as the naive combinations L~ R,T ·V~ are again
indeterminate due to the uncertainty in the sign of L~ R,T .
We can form an invariant quantity by taking the absolute
value of the scalar product,
|LRV | ≡





X
i
LRiVi





(8)
|LT V | ≡





X
i
LT iVi





, (9)
which can be used to study the correlation of L~ R,T with
the initial conditions. Notice that more information is
available when we are able to break the degeneracy [41].
3
For each variable V of the form LαMLα or |LαV | with
α ∈ {R, T} we then evaluate the average hVi over the
galaxies in our sample. To determine the probability of
observing such hVi in case of uncorrelated spins L~ R,T and
initial conditions (as represented by Mij / Vi), we calculate V for many mock galaxy catalogs in which the galaxy
positions are kept fixed but we randomly shuffle the parameters α, R that determine the galaxy spins L~ R,T . As
a result, we get the mean and standard deviation V¯, σV
of this random mock distribution, which allows us to calculate the statistical significance of the detected excess
correlation
S =

hVi − V¯


σV
. (10)
Notice it is incorrect to shuffle the vectors L~
T ,R themselves.
C. Functions of initial conditions
In this section we introduce variables Mij , Vi we use to
characterize the initial conditions and which we correlate
with the galaxy spins described by L~ R,T .
It has been shown in both simulations [9] and observations [41] that galaxy spins correlate with the vector
field L~ IC defined in terms of the smoothed initial density
ρ
r
ini and gravitational potential φ
r
ini as
L
IC
i =
X
jkl
ijk ∂jlφ
r
ini ∂lkρ
r
ini. (11)
The superscript r symbolizes the fields have been
smoothed on scale r ∼ O(h
−1Mpc). The unit norm vector field LˆIC = L~ IC/|L
IC| is then the first observable built
from the initial conditions we correlate with the galaxy
spins.
It has long been understood that tidal field in the vicinity of a protohalo plays a crucial role in determining the
halo’s spin [15]. This motivates us to pick the unit traceless local shear tensor Tˆ [8] as our second variable. It is
built from the shear tensor, defined as
Tij = ∂ijφ
r
ini, (12)
by first subtracting the trace
T˜
ij = Tij −
δij
3
X
k
Tkk (13)
and then normalizing
Tˆ
ij =
T˜
q
ij
P
ij T˜2
ij
. (14)
The tidal-torque theory [13–17] predicts that the correlation hLαT Lˆ
αi should vanish [8]: Assuming Gaussian
initial conditions, initial perturbation φini and its reverse −φini are equally likely. However, the observable
hLαT Lˆ
αi is not invariant under the operation φini →
−φini as Tˆ
ij changes sign but the quadratic form Lα,iLα,j
does not. Physically, tidal-torque theory predicts equal
alignments of galaxy spins with major and minor principal axes of Tˆ, which leads to cancellations in hLαT Lˆ
αi.
Because vanishing of hLαT Lˆ
αi is a realistic possibility,
we also consider correlations with the second power of Tˆ.
One can expect similar sensitivity to the second derivative of the initial density field, which can serve as a proxy
for the protohalo’s moment of inertia [29, 41]. We thus
also investigate correlations with first and second power
of ˆIij , defined similarly to Tˆ
ij but with φ
r
ini in (12) replaced by ρ
r
ini.
Finally, tidal-torque theory provides theoretical arguments that the galaxy spins should preferentially orient
with the intermediate principal axis Lˆφ
0
of the shear tensor Tˆ [7]. In the limit where the tensor ˆI can be used
as a proxy for the protohalo moment of inertia, the same
arguments can be used to justify expectation of correlation of galaxy spins with the intermediate principal axis
Lˆρ
0
of ˆI. The two unit vectors Lˆφ,ρ
0
are then the last
two observables built from the initial conditions that we
consider in this work.
Overall, we study correlations with seven objects
constructed from the initial conditions: four matrices
T , ˆ

Tˆ
2
,
ˆI, 
ˆI
2
and three vectors Lˆφ
0
,Lˆρ
0
,LˆIC. We correlate them with either L~ R or L~
T , which leads to 14 combinations to study for each of the smoothing scales we
consider. Because we talk about the initial conditions,
all these variables are evaluated at the Lagrangian positions of the galaxies.
III. DATA
In this section we present the data used in this work.
We start by describing the initial conditions as reconstructed by the ELUCID collaboration and then introduce the data used to determine angular momenta and
positions of galaxies.
A. Initial conditions
The initial density field ρini used in this work was obtained by the ELUCID collaboration, extended details
about their methodology can be found in [42, 48].
They first created a catalog of galaxy groups from the
Sloan Digital Sky Survey (SDSS) data [49] and then estimated mass of each group via a luminosity-based abundance matching. After correcting for peculiar velocities,
they only retained groups in the Northern Galactic Cap,
redshift range 0.01 ≤ z ≤ 0.12 and with masses above
1012M. The space was then tessellated according to
4
which galaxy group was the closest. Within the resulting
sub-volumes, particles were placed randomly, in accordance with the expected density profile for halo of given
mass. This particle distribution represents today’s density field.
In the second step of the reconstruction, ELUCID collaboration determined the best fit initial conditions by
repeatedly running a Particle-Mesh (PM) dynamics code
in a Hamiltonian Monte Carlo fashion. For each random
set of initial conditions, the PM code was used to calculate the corresponding value of today’s density field. This
density field was compared with that determined from
the SDSS data and their relative closeness was quantified using a predefined measure. As the PM code is inaccurate on small scales, before comparison both density
fields were smoothed on a scale of 4 Mpc/h. Iteratively
probing the space of initial conditions then allowed ELUCID to find the initial conditions that best describe the
local galaxy data.
From the best fit ρini, we use the Poisson equation to
calculate the initial gravitational potential φini.
In [41] we found that with Elucid ICs, galaxy spins are
best predicted when smoothing the initial conditions with
r ∼ 3 Mpc/h. In this work we consider this smoothing
scale, together with r ∼ 2 Mpc/h and r ∼ 4 Mpc/h to
allow for the possibility of a potentially different optimal
smoothing scale for the observables studied here.
B. Galaxy shapes
Galaxy data used in this work were obtained by SDSS
[4, 44] and we downloaded them from CasJobs*2. First
we use the Galaxy Zoo classifications [50] to select only
spiral galaxies. For each such galaxy we obtain its right
ascension, declination, redshift, position angle and axis
ratio. As our default combination, for the position angle
and axis ratio we use results of the fit of the de Vaucouleurs profile to the galaxy images obtained using the
green SDSS filter. For systematic checks we also investigate other choices. As in our previous work, we only
consider galaxies for which the closest Elucid halo was
at least 1012M to avoid regions with poorly determined
ICs.
For each galaxy, we calculate the vectors L~ R,T according to (3). The redshift and sky position then allows us to
find each galaxy’s three-dimensional Euclidian position.
Using the simulation ran from the optimal ICs, we then
find the galaxy’s inverse displacement, which we use to
calculate the Lagrangian position of the galaxy.
Our fiducial catalog contains 50361 galaxies in the volume in which Elucid provides the initial conditions.
*2 https://skyserver.sdss.org/CasJobs/
TABLE I. Significances S of excess correlations in terms of
number of standard deviations.
Smoothing scale r
2 h
−1Mpc 3 h
−1Mpc 4 h
−1Mpc
LRT Lˆ R 5.5 6.4 6.6
LT T Lˆ T 0.9 0.6 0.3
LR(Tˆ)
2LR 4.8 4.0 2.9
LT (Tˆ)
2LT 2.5 2.7 2.7
LRILˆ R 1.3 3.0 4.4
LT ILˆ T 1.4 1.1 0.6
LR(Iˆ)
2LR 0.9 1.9 3.3
LT (Iˆ)
2LT 0.2 0.3 0.9
|LRL
φ
0
| 3.8 3.4 2.6
|LT L
φ
0
| 1.6 2.3 1.6
|LRL
ρ
0
| 1.1 1.5 2.1
|LT L
ρ
0
| 0.2 0.7 0.4
|LRL
IC | 2.3 2.8 2.2
|LT L
IC | 0.0 1.1 2.0
IV. RESULTS
In Fig. 1 we show our main result - excess correlation
between the galaxy spins L~ R,T inferred from the galaxy
shapes and various observables built from the initial conditions. We summarize the detection significances S in
Table I. To estimate the error bars, we shuffled R and
α total of 40000 times, which is enough to converge the
results to below 0.05 standard deviation.
The strongest correlation we find is with the tidal
tensor Tˆ, which is significant for all three investigated
smoothing scales r. We also see strong excess correlation between the galaxy spins and 
Tˆ
2
smoothed with
r = 2 h
−1Mpc and r = 3 h
−1Mpc and ˆI smoothed with
r = 4 h
−1Mpc. No other correlations reach 4σ significance.
We perform several tests to check for systematics. First
we repeat the calculations assuming all galaxies have intrinsic flatness p = 0.1. This does not lead to any significant change in the results and neither does assuming p = 0.2. As an alternative study of the effect of
the galaxy thickness, we uniformly redistribute all R in
the interval [0, 1] while keeping their original ordering
[8]. Simultaneously we perform the same procedure on
α. Typical detection significance after this “isotropizing”
rearrangement increases slightly, and no significance decreases by more than ∼ 0.1 standard deviation. Similar
situation repeats when we use axis ratios and position angles from fits to the images obtained with the red SDSS
filter: overall increase of the significances, with decreases
of no more than ∼ 0.15 standard deviations.
The most dramatic change is observed when we use
5
L
R
ˆ
T L
R
L
T
ˆ
T L
T
L
R
(
ˆT
)
2
L
R
L
T
(
ˆT
)
2
L
T
L
R
ˆ
IL
R
L
T
ˆ
IL
T
L
R
(
ˆI
)
2
L
R
L
T
(
ˆI
)
2
L
T
|L
R
ˆL
φ
0
|
|L
T
ˆL
φ
0
|
|L
R
ˆL
ρ
0
|
|L
T
ˆL
ρ
0
|
|L
R
ˆLIC|
|L
T
ˆLIC
−3×10 |
−3
−2×10−3
−1×10−3
0
10−3
2×10−3
3×10−3
4×10−3
Excess over random, hVi −
¯V
2 h
−1Mpc 3 h
−1Mpc 4 h
−1Mpc
FIG. 1. Excess correlations of galaxy spins with various vectors and tensors derived from the initial conditions. Different colors
represent different smoothing scales r used to calculate the vectors and tensors.
galaxy shapes obtained by fitting the exponential profile
to the galaxy images, instead of the de Vaucouleurs one.
The detection significance of LRT Lˆ R, the observable we
detect with the highest significance, drops by almost a
full standard deviation and for the three smoothing scales
ends up in the 4.9 – 5.7 σ range. The other correlations
are only changed within ±0.2σ.
We take 5.7σ as a conservative estimate of the maximal discovered correlation. Because of the look-elsewhere
effect, it is not possible to claim a 5.7σ detection of correlation between the galaxy shapes and the initial condition
given we investigate 42 different variables (listed in Table I). The overall detection significance can be bounded
from below by calculating the probability of finding 5.7σ
or larger effect among 42 independent observations. It is
P = 1 −
Z 5.7
−5.7
exp(−x
2/2)
√
2π
dx
42
= 5 × 10−7
, (15)
which corresponds to ∼ 5σ.
Correlations between the variables increase the detection significance, so to get a better estimate we take the
covariance of the various observables V into account. We
estimate this covariance from the random reshuffling of
R and α we used earlier to calculate σ
2
V
. We then simulate random draws from a Gaussian distribution with
this covariance. We find that draws where any variable
deviates by more than 5.7σ from its expected value occur with probability 2 × 10−7
, which translates into our
final estimate of the significance ∼ 5.2σ. Had we started
with the maximal local significance 6.6σ we see when the
results are based on fits of the de Vaucouleurs profile,
we would obtain a proportionally larger global detection
significance.
Finally, we looked at the correlations in four bins in
either redshift (Fig. 2) or halo mass (as estimated by
ELUCID, Fig. 3) for the smoothing length r = 4 h
−1Mpc,
where we see the most significant detection. We see mild
trends in some of the observables, but given the large
number of investigated data points it is expected to see
dependencies just by pure chance and we do not pursue
this issue further. We thus mainly use these splits as
an additional systematic check. Given all redshift and
halo mass bins lead to generally consistent results, we
have checked that our results are not dominated by any
outlier. These splits also serve as a rough check on the
size of our error bars.
V. DISCUSSION
In this work we studied correlations between directions of galaxy angular momenta determined from galaxy
shapes (axis ratios and position angles) and various observables built from the initial density and gravitational
potential.
We found a statistically significant correlation between
the radial component of the galaxy spin L~ R and the tidal
field in the vicinity of the protohalo (specifically the unit
traceless shear tensor Tˆ). Physically this correspond to
galaxies being preferentially oriented face on (edge on)
in places where the major (minor) axis of the tidal field
aligns with the line of sight. The detection was significant
6
L
R
ˆ
T L
R
L
T
ˆ
T L
T
L
R
(
ˆT
)
2
L
R
L
T
(
ˆT
)
2
L
T
L
R
ˆ
IL
R
L
T
ˆ
IL
T
L
R
(
ˆI
)
2
L
R
L
T
(
ˆI
)
2
L
T
|L
R
ˆL
φ
0
|
|L
T
ˆL
φ
0
|
|L
R
ˆL
ρ
0
|
|L
T
ˆL
ρ
0
|
|L
R
ˆLIC|
|L
T
ˆLIC
−6×10 |
−3
−4×10−3
−2×10−3
0
2×10−3
4×10−3
6×10−3
8×10−3
Excess over random, hVi −
¯V
FIG. 2. Testing the redshift evolution. The black points correspond to the results obtained using all galaxies, already shown
in Fig. 1. Each blue point represents results derived with a quarter of the galaxies, split based on their redshift. The darker
the blue point, the further the galaxies are (i.e. the lightest/darkest blue points represent the results obtained using only the
25% closest/furthest galaxies). All with r = 4 h
−1Mpc.
L
R
ˆ
T L
R
L
T
ˆ
T L
T
L
R
(
ˆT
)
2
L
R
L
T
(
ˆT
)
2
L
T
L
R
ˆ
IL
R
L
T
ˆ
IL
T
L
R
(
ˆI
)
2
L
R
L
T
(
ˆI
)
2
L
T
|L
R
ˆL
φ
0
|
|L
T
ˆL
φ
0
|
|L
R
ˆL
ρ
0
|
|L
T
ˆL
ρ
0
|
|L
R
ˆLIC|
|L
T
ˆLIC
−6×10 |
−3
−4×10−3
−2×10−3
0
2×10−3
4×10−3
6×10−3
8×10−3
Excess over random, hVi −
¯V
FIG. 3. Testing the halo mass dependence. As Fig. 2, only galaxies are split into bins according to the halo mass (as
determined by ELUCID). Lighter blue represents galaxies in lighter haloes.
7
at the 5.5σ – 6.6σ level when we use galaxy shape parameters determined from the de Vaucouleurs fit to the SDSS
galaxy images, the largest significance was found when
smoothing the initial conditions with r = 4 h
−1Mpc.
With shape parameters determined from the exponential
fit to the galaxy images, the detection significance drops
to 4.9σ – 5.7σ. Considering the look-elsewhere effect, we
estimate the global detection significance at 5.2σ.
We explain above that the tidal-torque theory predicts
vanishing hLRT Lˆ Ri. As this theory is based on the first
order perturbation theory described by the Zeldovich approximation, detection reported in this paper suggests
we are detecting a non-perturbative effect. This complements earlier reports pointing out limitations of the
tidal-torque theory (e.g. [16, 51]).
When smoothing with r = 4 h
−1Mpc, we also find correlation with the unit traceless inertia tensor ˆI, with local
significance of 4.4σ. Interestingly, at about 2.8σ significance we detect correlation with the spin galaxy proxy
LˆIC. This is comparable to what was found in [41] with a
smaller number of galaxies, though with access to additional information that allowed us to break the four-fold
degeneracy.
In general, excess signals are compatible when using either L~ R or L~
T , galaxy spin vectors parallel and tangential
to the line of sight. The error bars are always larger for
correlations including L~
T , which is understandable given
that the position angle α acts as an additional source of
uncertainty.
The initial conditions as provided by ELUCID are increasingly uncertain on smaller and smaller scales. It
is unclear whether our detection is limited by this uncertainty, or by other factors, such as the late time evolution
of the galaxy spins.
Overall, we have shown that galaxy shapes of spiral
galaxies, explicitly the axis ratios of their images, provide additional information about the initial conditions.
It is thus possible that including the galaxy shape measurements in the reconstruction efforts such as described
in [48, 52–56] might improve the process of reconstruction of the initial conditions in the Universe, though this
prospect warrants further investigation in simulations.
